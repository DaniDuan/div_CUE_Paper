setwd('../../div_cue_paper/data')
graphics.off()
library(minpack.lm)
library(ggplot2)
library(reshape2)
library(grid)
k = 8.61*10^(-5)
logSchoolfield = function(Temp, lnB0, T_pk, Ea, E_D){
return(lnB0-Ea*(1/Temp-1/273.15)/k-log(1+(Ea/(E_D-Ea))*exp(E_D*(1/T_pk-1/Temp)/k)))
}
Schoolfield = function(Temp, B0, T_pk, Ea, E_D){
return(B0*exp(-Ea*(1/Temp-1/273.15)/k)/(1+(Ea/(E_D-Ea))*exp(E_D*(1/T_pk-1/Temp)/k)))
}
CUE = function(G, R){
return(G/(G+R))
}
data = read.csv("./aerobic_tpc_data.csv")
summ = read.csv("./summary.csv")
summ = summ[-which(summ$Points_Before_Peak < 3),]
summ = summ[which(summ$Trait == "Specific Growth Rate"),]
summ = summ[-which(summ$AIC > 100),]
summ = summ[-which(summ$E_D < summ$E),]
summ = summ[-which(summ$T_pk > 370),]
summ = summ[-which(summ$E_D > 30),]
summ = summ[which(summ$ConKingdom == 'Bacteria'),]
#summ = summ[which(summ$B0>0),]
s_data = data.frame(summ$X, summ$Species, summ$B0, summ$E, summ$T_pk, summ$E_D, summ$R_Squared, summ$AIC, summ$BIC)
names(s_data) = c('ID', 'Species', 'B0', 'Ea', 'T_pk', 'E_D', 'r_sq', 'AIC', 'BIC')
s_data = s_data[-which(s_data$Ea > 3),]
plot(1, type="n", xlab = "Temperature (celsius)", ylab = 'Growth Rate', xlim=c(0,100), ylim = c(0, 90))
for(i in 1:nrow(s_data)){
lines(x = 0:100, y = Schoolfield(Temp = 273.15:373.15, B0 = exp(s_data$B0[i]), T_pk = s_data$T_pk[i], Ea = s_data$Ea[i], E_D = s_data$E_D[i]), typ = 'l')
}
par(mar=c(7,7,7,1)+.1)
plot(1, type="n", xlab = "Temperature (celsius)", ylab = 'Growth Rate (1/Time)', xlim=c(0,60), ylim = c(0, 90), cex.lab=2.5, cex.axis=2.5)
for(i in 1:nrow(s_data)){
lines(x = 0:60, y = Schoolfield(Temp = 273.15:333.15, B0 = exp(s_data$B0[i]), T_pk = s_data$T_pk[i], Ea = s_data$Ea[i], E_D = s_data$E_D[i]), typ = 'l', col = alpha('black',0.5), lwd = 2)
}
text(-8,105, 'A', cex = 3, xpd = NA)
plot(1, type="n", xlab = "Temperature (celsius)", ylab = 'ln(Growth Rate)', xlim=c(0, 100), ylim=c(-5, 3.5))
for(i in 1:nrow(s_data)){
lines(logSchoolfield(Temp = 273.15:373.15, lnB0 = exp(s_data$B0[i]), T_pk = s_data$T_pk[i], Ea = s_data$Ea[i], E_D = s_data$E_D[i]), typ = 'l')
}
summ = read.csv("./summary.csv")
summ = summ[-which(summ$Points_Before_Peak < 3),]
summ = summ[which(summ$Trait == "Specific Growth Rate"),]
summ = summ[-which(summ$AIC > 100),]
summ = summ[-which(summ$E_D < summ$E),]
summ = summ[-which(summ$T_pk > 370),]
summ = summ[-which(summ$E_D > 30),]
summ = summ[which(summ$ConKingdom == 'Bacteria'),]
#summ = summ[which(summ$B0>0),]
s_data = data.frame(summ$X, summ$Species, summ$B0, summ$E, summ$T_pk, summ$E_D, summ$R_Squared, summ$AIC, summ$BIC)
names(s_data) = c('ID', 'Species', 'B0', 'Ea', 'T_pk', 'E_D', 'r_sq', 'AIC', 'BIC')
s_data = s_data[-which(s_data$Ea > 2),]
cov(s_data$B0, s_data$Ea)
var(s_data$B0)
s_data$B0
mean(s_data$B0)
var(s_data$B0)
var(s_data$Ea)
mean(s_data$Ea)
mean(s_data$B0); var(s_data$B0)
mean(s_data$Ea); var(s_data$Ea)
cov(s_data$B0, s_data$Ea)
exp(s_data$B0)
mean(exp(s_data$B0))
data = read.csv("./aerobic_tpc_data.csv")
data = data[-which(data$temps_before_peak_resp<=3 | data$temps_before_peak_growth<=3),]
res_data = data.frame(data$E_resp, data$B0_resp, data$E_D_resp, data$Tpk_resp, data$Ppk_resp, data$r_sq_resp)
names(res_data) = c('Ea', 'B0', 'E_D', 'T_pk', 'P_pk','r_sq')
grow_data = data.frame(data$E_growth, data$B0_growth, data$E_D_growth, data$Tpk_growth, data$Ppk_growth, data$r_sq_growth)
names(grow_data) = c('Ea', 'B0', 'E_D', 'T_pk', 'P_pk','r_sq')
##### Growth ######
plot(1, type="n", xlab = "Temperature(celsius)", ylab = 'growth rate', xlim=c(0, 50), ylim = c(0, 0.8))
for(i in 1:nrow(grow_data)){
lines(Schoolfield(Temp = 273.15:323.15, B0 = grow_data$B0[i], T_pk = grow_data$T_pk[i], Ea = grow_data$Ea[i], E_D = grow_data$E_D[i]), typ = 'l')
}
plot(1, type="n", xlab = "Temperature(celsius)", ylab = 'ln(growth rate)', xlim=c(0, 50), ylim=c(-15, 0))
for(i in 1:nrow(grow_data)){
lines(logSchoolfield(Temp = 273.15:323.15, lnB0 = log(grow_data$B0[i]), T_pk = grow_data$T_pk[i], Ea = grow_data$Ea[i], E_D = grow_data$E_D[i]), typ = 'l')
}
####### Respiration ######
plot(1, type="n", xlab = "Temperature(celsius)", ylab = 'respiration rate', xlim=c(0, 50), ylim = c(0, 6))
for(i in 1:nrow(res_data)){
lines(Schoolfield(Temp = 273.15:323.15, B0 = res_data$B0[i], T_pk = res_data$T_pk[i], Ea = res_data$Ea[i], E_D = res_data$E_D[i]), typ = 'l')
}
plot(1, type="n", xlab = "Temperature(celsius)", ylab = 'ln(respiration rate)', xlim=c(0, 50), ylim=c(-7, 2))
for(i in 1:nrow(res_data)){
lines(logSchoolfield(Temp = 273.15:323.15, lnB0 = log(res_data$B0[i]), T_pk = res_data$T_pk[i], Ea = res_data$Ea[i], E_D = res_data$E_D[i]), typ = 'l')
}
G = Schoolfield(Temp = 273.15:323.15, B0 = grow_data$B0[i], T_pk = grow_data$T_pk[i], Ea = grow_data$Ea[i], E_D = grow_data$E_D[i])
R = Schoolfield(Temp = 273.15:323.15, B0 = res_data$B0[i], T_pk = res_data$T_pk[i], Ea = res_data$Ea[i], E_D = res_data$E_D[i])
plot(1, type="n", xlab = "Temperature(celsius)", ylab = 'CUE', xlim=c(0, 50), ylim=c(0, 1))
for(i in 1:nrow(grow_data)){
lines(CUE(G = Schoolfield(Temp = 273.15:323.15, B0 = grow_data$B0[i], T_pk = grow_data$T_pk[i], Ea = grow_data$Ea[i], E_D = grow_data$E_D[i]), R = Schoolfield(Temp = 273.15:323.15, B0 = res_data$B0[i], T_pk = res_data$T_pk[i], Ea = res_data$Ea[i], E_D = res_data$E_D[i])), typ = 'l')
}
View(res_data)
exp(res_data$B0)
mean(exp(res_data$B0))
mean(res_data)
mean(res_data, na.rm = T)
mean(res_data$B0)
exp(mean(res_data$B0))
var(res_data$B0)
var(res_data$Ea)
cov(res_data$B0, res_data$Ea)
mean(s_data$B0); var(s_data$B0)
mean(s_data$Ea); var(s_data$Ea)
G = Schoolfield(Temp = 273.15:323.15, B0 = grow_data$B0[i], T_pk = grow_data$T_pk[i], Ea = grow_data$Ea[i], E_D = grow_data$E_D[i])
R = Schoolfield(Temp = 273.15:323.15, B0 = res_data$B0[i], T_pk = res_data$T_pk[i], Ea = res_data$Ea[i], E_D = res_data$E_D[i])
plot(1, type="n", xlab = "Temperature(celsius)", ylab = 'CUE', xlim=c(0, 50), ylim=c(0, 1))
for(i in 1:nrow(grow_data)){
lines(CUE(G = Schoolfield(Temp = 273.15:323.15, B0 = grow_data$B0[i], T_pk = grow_data$T_pk[i], Ea = grow_data$Ea[i], E_D = grow_data$E_D[i]), R = Schoolfield(Temp = 273.15:323.15, B0 = res_data$B0[i], T_pk = res_data$T_pk[i], Ea = res_data$Ea[i], E_D = res_data$E_D[i])), typ = 'l')
}
CUE_Values= data.frame()
for(i in 1:nrow(grow_data)){
CUE_Values = rbind(CUE_Values, CUE(G = Schoolfield(Temp = 273.15, B0 = grow_data$B0[i], T_pk = grow_data$T_pk[i], Ea = grow_data$Ea[i], E_D = grow_data$E_D[i]), R = Schoolfield(Temp = 273.15:323.15, B0 = res_data$B0[i], T_pk = res_data$T_pk[i], Ea = res_data$Ea[i], E_D = res_data$E_D[i])))
}
CUE(G = Schoolfield(Temp = 273.15:323.15, B0 = grow_data$B0[i], T_pk = grow_data$T_pk[i], Ea = grow_data$Ea[i], E_D = grow_data$E_D[i]), R = Schoolfield(Temp = 273.15:323.15, B0 = res_data$B0[i], T_pk = res_data$T_pk[i], Ea = res_data$Ea[i], E_D = res_data$E_D[i]))
CUE_0 = grow_data$B0/(grow_data$B0+res_data$B0)
hist(CUE_0)
mean(CUE_0)
mean(CUE_0) - sd(CUE_0)/sqrt(nrow(grow_data))
mean(CUE_0) + sd(CUE_0)/sqrt(nrow(grow_data))
mean(CUE_0)
var(CUE_0)
CUE_0
CUE_0 + 0.4
mean(exp(s_data$B0))
res_data$B0
grow_data$B0
View(data)
View(summ)
cov(grow_data$B0, grow_data$Ea)
cov(grow_data$log(B0), grow_data$Ea)
log(B0)
cov(log(grow_data$B0), grow_data$Ea)
log(grow_data$B0)
s_data$B0
mean(log(grow_data$B0)); var(s_data$B0)
mean(log(grow_data$B0)); var(s_data$Ea)
cov(log(grow_data$B0), grow_data$Ea)
mean(log(grow_data$B0)); var(log(grow_data$B0))
mean(grow_data$Ea); var(grow_data$Ea)
cov(log(res_data$B0), res_data$Ea)
cov(log(res_data$B0), res_data$Ea)
mean(log(res_data$B0)); var(log(res_data$B0))
mean(res_data$Ea); var(res_data$Ea)
cov(s_data$B0, s_data$Ea)
mean(s_data$B0); var(s_data$B0)
mean(s_data$Ea); var(s_data$Ea)
var(s_data$Ea)/mean(s_data$Ea)
mean(s_data$B0)
mean(s_data$Ea)
var(s_data$B0)/mean(s_data$B0)
mean(res_data$Ea)
mean(log(res_data$B0))
mean(res_data$B0)
exp(0.14)
mean(log(res_data$B0))
cov(log(res_data$B0), res_data$Ea)
cov(log(grow_data$B0), grow_data$Ea)
mean(s_data$B0); var(s_data$B0)
mean(s_data$Ea); var(s_data$Ea)
mean(s_data$Ea)
mean(s_data$B0)
mean(s_data$B0); var(s_data$B0)
mean(s_data$Ea); var(s_data$Ea)
mean(log(grow_data$B0)); var(log(grow_data$B0))
mean(grow_data$B0)
mean(s_data$B0); var(s_data$B0)
##########################################################################
cov(s_data$B0, s_data$Ea)
var(log(res_data$B0))
mean(log(res_data$B0))
mean(res_data$B0)
mean(res_data$Ea)
var(log(res_data$B0))
var(s_data$B0)
mean(s_data$Ea)
var(res_data$Ea)
var(s_data$Ea)
cov(log(res_data$B0), res_data$Ea)
cov(log(grow_data$B0), grow_data$Ea)
mean(log(grow_data$B0)); var(log(grow_data$B0))
mean(s_data$Ea); var(s_data$Ea)
var(res_data$Ea)
mean(log(grow_data$B0)); var(log(grow_data$B0))
mean(s_data$B0); var(s_data$B0)
##########################################################################
cov(s_data$B0, s_data$Ea)
var(res_data$Ea)
var(s_data$Ea)
Schoolfield(10+273.15, exp(s_data$B0), s_data$T_pk, s_data$Ea, s_data$E_D)
B0_10 = Schoolfield(10+273.15, exp(s_data$B0), s_data$T_pk, s_data$Ea, s_data$E_D)
B0_10
mean(log(B0_10))
mean(log(B0_10)); var(log(B0_10))
B0_10_res = Schoolfield(10+273.15, res_data$B0, res_data$T_pk, res_data$Ea, res_data$E_D)
mean(log(B0_10_res)); var(log(B0_10_res))
mean(B0_10_res)
mean(log(B0_10)); var(log(B0_10))
mean(log(B0_10)); var(log(B0_10))
mean(B0_10_res)
mean(res_data$B0)
CUE_0
mean(log(B0_10)); var(log(B0_10))
mean(log(B0_10_res)); var(log(B0_10_res))
mean(grow_data$Ea); var(grow_data$Ea)
mean(log(B0_10)); var(log(B0_10))
mean(res_data$Ea); var(res_data$Ea)
cov(log(grow_data$B0), grow_data$Ea)
cov(log(res_data$B0), res_data$Ea)
##########################################################################
cov(s_data$B0, s_data$Ea)
mean(res_data$B0)
mean(B0_10_res)
mean(log(B0_10_res))
mean(log(B0_10))
B0_10_res
mean(B0_10_res)
# B0_10 = Schoolfield(10+273.15, exp(s_data$B0), s_data$T_pk, s_data$Ea, s_data$E_D)
# mean(log(B0_10)); var(log(B0_10))
mean(B0_10_res)/(1-0.22-0.4)
B0_u_10 = Schoolfield(10+273.15, B0_u, mean(s_data$T_pk), mean(s_data$Ea), mean(s_data$E_D))
# B0_10 = Schoolfield(10+273.15, exp(s_data$B0), s_data$T_pk, s_data$Ea, s_data$E_D)
# mean(log(B0_10)); var(log(B0_10))
B0_u = mean(B0_10_res)/(1-0.22-0.4)
B0_u_10 = Schoolfield(10+273.15, B0_u, mean(s_data$T_pk), mean(s_data$Ea), mean(s_data$E_D))
B0_u_10
log(B_u_10)
log(B0_u_10)
var(log(res_data$B0))
mean(log(B0_10_res)); var(log(B0_10_res))
cov(log(grow_data$B0), grow_data$Ea)
# load packages
library(rTPC)
library(nls.multstart)
library(broom)
library(tidyverse)
library(progress)
#load datasets
df_meta <- read.csv("./data/database.csv") %>%
filter(StandardisedTraitName == "Specific Growth Rate") %>%
select(Strain = OriginalID,growth_rate = StandardisedTraitValue,Temperature = ConTemp)  %>%
mutate(source = "meta")
