install.packages(c("ggplot2", "reshape2", "minpack.lm"))
install.packages("ggplot2")
install.packages(c("ggplot2", "reshape2", "minpack.lm"))
install.packages("grid")
source("~/Documents/div_cue_paper/code/TPC_processing.R", encoding = 'UTF-8')
setwd("~/Documents/div_cue_paper/code/")
library(ggplot2)
EMP_data = read.csv("../data/EMP.csv", header = T)
names(EMP_data) = c("ID", "Sample", "Temp", "pH", "Richness")
EMP_data = subset(EMP_data,Temp != "" & Temp <= 25 & Temp > 0)
scatter.smooth(EMP_data$Temp, EMP_data$Richness)
m = max(EMP_data$Richness)
EMP_data$relative_rich = EMP_data$Richness/m
scatter.smooth(EMP_data$Temp, EMP_data$relative_rich)
# write.csv(EMP_data, "../data/EMP_filtered.csv", row.names=T)
quantile(EMP_data$relative_rich, probs = 0.99)
quan = c()
for(i in unique(EMP_data$Temp)){
sub = subset(EMP_data, Temp == i)
quan = c(quan, quantile(sub$relative_rich, probs = 0.99))
}
quan
EMP_data = read.csv("../data/EMP.csv", header = T)
names(EMP_data) = c("ID", "Sample", "Temp", "pH", "Richness")
EMP_data = subset(EMP_data,Temp != "" & Temp <= 30 & Temp > 0)
scatter.smooth(EMP_data$Temp, EMP_data$Richness)
m = max(EMP_data$Richness)
EMP_data$relative_rich = EMP_data$Richness/m
scatter.smooth(EMP_data$Temp, EMP_data$relative_rich)
quantile(EMP_data$relative_rich, probs = 0.99)
quan = c()
for(i in unique(EMP_data$Temp)){
sub = subset(EMP_data, Temp == i)
quan = c(quan, quantile(sub$relative_rich, probs = 0.99))
}
write.csv(EMP_data, "../data/EMP_filtered.csv", row.names=T)
CUE_Values= data.frame()
for(i in 1:nrow(grow_data)){
CUE_Values = rbind(CUE_Values, CUE(G = Schoolfield(Temp = 273.15, B0 = grow_data$B0[i], T_pk = grow_data$T_pk[i], Ea = grow_data$Ea[i], E_D = grow_data$E_D[i]), R = Schoolfield(Temp = 273.15:323.15, B0 = res_data$B0[i], T_pk = res_data$T_pk[i], Ea = res_data$Ea[i], E_D = res_data$E_D[i])))
}
EMP_data = read.csv("../data/EMP.csv", header = T)
names(EMP_data) = c("ID", "Sample", "Temp", "pH", "Richness")
EMP_data = subset(EMP_data,Temp != "" & Temp <= 30 & Temp > 0)
scatter.smooth(EMP_data$Temp, EMP_data$Richness)
m = max(EMP_data$Richness)
EMP_data$relative_rich = EMP_data$Richness/m
scatter.smooth(EMP_data$Temp, EMP_data$relative_rich)
setwd('../../div_cue_paper/data')
graphics.off()
library(minpack.lm)
library(ggplot2)
library(reshape2)
library(grid)
k = 8.61*10^(-5)
logSchoolfield = function(Temp, lnB0, T_pk, Ea, E_D){
return(lnB0-Ea*(1/Temp-1/273.15)/k-log(1+(Ea/(E_D-Ea))*exp(E_D*(1/T_pk-1/Temp)/k)))
}
Schoolfield = function(Temp, B0, T_pk, Ea, E_D){
return(B0*exp(-Ea*(1/Temp-1/273.15)/k)/(1+(Ea/(E_D-Ea))*exp(E_D*(1/T_pk-1/Temp)/k)))
}
CUE = function(G, R){
return(G/(G+R))
}
data = read.csv("./aerobic_tpc_data.csv")
data = data[-which(data$temps_before_peak_resp<=3 | data$temps_before_peak_growth<=3),]
res_data = data.frame(data$E_resp, data$B0_resp, data$E_D_resp, data$Tpk_resp, data$Ppk_resp, data$r_sq_resp)
names(res_data) = c('Ea', 'B0', 'E_D', 'T_pk', 'P_pk','r_sq')
grow_data = data.frame(data$E_growth, data$B0_growth, data$E_D_growth, data$Tpk_growth, data$Ppk_growth, data$r_sq_growth)
names(grow_data) = c('Ea', 'B0', 'E_D', 'T_pk', 'P_pk','r_sq')
G = Schoolfield(Temp = 273.15:323.15, B0 = grow_data$B0[i], T_pk = grow_data$T_pk[i], Ea = grow_data$Ea[i], E_D = grow_data$E_D[i])
R = Schoolfield(Temp = 273.15:323.15, B0 = res_data$B0[i], T_pk = res_data$T_pk[i], Ea = res_data$Ea[i], E_D = res_data$E_D[i])
##########################################################################
cov(s_data$B0, s_data$Ea)
